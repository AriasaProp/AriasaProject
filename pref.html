<!DOCTYPE html>
<html lang='en'>
<head>
  <title>Fermity - Preference</title>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <meta name='author' content='AriasaProp'>
  <meta name='description' content='Preference Theme.'>
  <link rel='apple-touch-icon' sizes='180x180' href='/apple-touch-icon.png'>
  <link rel='icon' type='image/png' sizes='32x32' href='/favicon-32x32.png'>
  <link rel='icon' type='image/png' sizes='16x16' href='/favicon-16x16.png'>
  <link rel='manifest' href='/site.webmanifest'>
  <link rel='preconnect' href='https://fonts.googleapis.com' crossorigin>
  <link rel='preconnect' href='https://fonts.gstatic.com' crossorigin>
  <link rel='preload' href='https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;700' as='style' onload="this.onload=null;this.rel='stylesheet'">
  <link rel='preload' href='https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght@28,700' as='style' onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;700'>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,opsz@200,28'>
  </noscript>
  <link rel='stylesheet' href='styles/common.css'>
  <link rel='stylesheet' href='styles/pref.css'>
  <script src='scripts/common.js'></script>
</head>
<body>
  <noscript><span id='blocked'>Blocked: [need javascript to load!]</span></noscript>
  <header>
    <nav>
      <a href='/'><h2>Fermity</h2></a>
      <span></span>
      <input id='ai' type='checkbox'>
      <label id='al' for='ai' class='material-symbols-outlined'></label>
      <form id='ab' action='/' method='GET'>
        <input name='s' type='text' placeholder='Search' required>
        <button type='reset' class='material-symbols-outlined'>&#xe6d0;</button>
        <button type='submit' class='material-symbols-outlined'>&#xe8b6;</button>
      </form>
    </nav>
  </header>
  <main>
    <h1>Customize</h1>
    <form id='sett'>
      <label for='primaryColor'>
        <p>Primary Color</p>
        <input type='hidden' name='primaryColor'>
        <span></span>
      </label>
      <label for='accentColor'>
        <p>Accent Color</p>
        <input type='hidden' name='accentColor'>
        <span></span>
      </label>
      <label for='fontColor'>
        <p>Font Color</p>
        <input type='hidden' name='fontColor'>
        <span></span>
      </label>
      <br>
      <div class='kc'>
        <h4>Font Size</h4>
        <div>
          <p>A</p>
          <input name='fontSize' type='range' min='12' step='1' max='16'>
          <p>A</p>
        </div>
      </div>
      <br>
      <button type='reset' disabled><i class='material-symbols-outlined'>&#xe872;</i>Reset</button>
      <button type='submit' disabled><i class='material-symbols-outlined'>&#xf5a6;</i>Apply</button>
    </form>
  </main>
  <script>
function updateColorPicker(p, a, b) {
  if (!p) return;
  if (!a) return;
  let pos = {x: 0,y: 0};
  let deg;
  if (b) { // input offset
    pos.x = a - p.c.x, 
    pos.y = b - p.c.y
    deg = Math.round(180 * (1 + Math.atan2(pos.y, pos.x) / Math.PI));
    const scl = 60 / Math.sqrt(Math.pow(pos.x, 2) + Math.pow(pos.y, 2));
    pos.x *= scl;
    pos.y *= scl;
  } else {
    deg = parseInt(a);
    pos.x = 60 * -Math.cos(deg / 180 * Math.PI);
    pos.y = 60 * -Math.sin(deg / 180 * Math.PI);
  }
  p.obj.value = deg;
  pos.x -= p.knob.clientWidth * 0.5;
  pos.y -= p.knob.clientHeight * 0.5;
  p.knob.style.rotate = `${deg - 135}deg`;
  p.knob.style.translate =`${pos.x}px ${pos.y}px`;
  const lg = getComputedStyle(p.obj).getPropertyValue('--lght');
  p.lbl.style.setProperty('--hue', deg);
}
let colorPickerConstant = [
  {k: 'primaryColor'},
  {k: 'accentColor'},
  {k: 'fontColor'}];
colorPickerConstant.forEach(p => {
  p.obj = sett.elements[p.k];
  p.lbl = p.obj.parentNode;
  p.knob = p.lbl.children[2];
  p.c = {
    x: p.lbl.clientWidth * 0.5,
    y: p.lbl.clientHeight * 0.5
  };
  updateColorPicker(p, theme_val[p.k]);
  p.lbl.addEventListener('click', e => {
    updateColorPicker(p, e.offsetX, e.offsetY);
    sett.dispatchEvent(new Event('change'));
  });
});
let areset = sett.querySelector('button[type="reset"]');
let asubmit = sett.querySelector('button[type="submit"]');
sett.addEventListener('change', (e) => {
  areset.disabled = false;
  asubmit.disabled = false;
});
sett.addEventListener('reset', (e) => {
  areset.disabled = true;
  asubmit.disabled = true;
  colorPickerConstant.forEach(p => {
    updateColorPicker(p, theme_val[p.k]);
  });
});
sett.addEventListener('submit', (e) => {
  areset.disabled = true;
  asubmit.disabled = true;
  e.preventDefault();
  Object.keys(theme_val).forEach((k) => {
    let a = sett.elements[k];
    if (theme_val[k] !== a.value) {
      document.documentElement.style.setProperty(`--${k}`, a.value);
      theme_val[k] = a.defaultValue = a.value;
    }
  });
  localStorage.setItem('Theme', JSON.stringify(theme_val));
  colorPickerConstant.forEach(p => redrawClrPickC(p, theme_val[p.k]));
});
  </script>
  <footer>
    <a href='mailto:ikomangwidiadaariasa12@gmail.com'><p>Google mail</p></a>
    <a href='https://github.com/AriasaProp'><p>Github</p></a>
    <a href='#'><p>Instagram</p></a>
    <a href='#'><p>Facebook</p></a>
    <a href='#'><p>Twitter</p></a>
    <hr/>
    <p>2025 AriasaProp | Made for fun!</p>
  </footer>
</body>
</html>